# Default values for agentgateway-mcp
# Этот файл используется как базовый values.yaml для Helm чарта
# Для переопределений используйте values-dev.yaml или values-prod.yaml

# Конфигурация для MCP серверов (Multiplex MCP)
# Multiplex MCP объединяет несколько MCP серверов в один Backend
# Все серверы доступны через один endpoint /mcp
# Инструменты от разных серверов доступны с префиксом имени сервера
# Например: ia-mcp-1_tool-name, ia-mcp-2_tool-name, ia-mcp-3_tool-name
# Важно: поддерживается только streamable-http транспорт (SSE не поддерживается)
# Документация: https://agentgateway.dev/docs/kubernetes/latest/mcp/multiplex/
mcp:
  enabled: true
  # Список MCP серверов для развертывания
  # Все серверы будут объединены в один Backend с несколькими targets
  servers:
    - name: ia-mcp-1
      namespace: agentgateway-system
      image: ia-mcp:latest
      imagePullPolicy: Always
      port: 8000
      replicas: 5
      # Путь MCP endpoint на самом сервере (опционально, по умолчанию /mcp для streamable-http)
      # mcpPath: /mcp
      env:
        - name: MCP_HOST
          value: "0.0.0.0"
        # streamable-http обязателен для Multiplex MCP
        - name: MCP_TRANSPORT
          value: "streamable-http"
        - name: COLUMNS
          value: "200"
    - name: ia-mcp-2
      namespace: agentgateway-system
      image: ia-mcp:latest
      imagePullPolicy: Always
      port: 8000
      replicas: 5
      env:
        - name: MCP_HOST
          value: "0.0.0.0"
        - name: MCP_TRANSPORT
          value: "streamable-http"
        - name: COLUMNS
          value: "200"
    - name: ia-mcp-3
      namespace: agentgateway-system
      image: ia-mcp:latest
      imagePullPolicy: Always
      port: 8000
      replicas: 5
      env:
        - name: MCP_HOST
          value: "0.0.0.0"
        - name: MCP_TRANSPORT
          value: "streamable-http"
        - name: COLUMNS
          value: "200"
  # Конфигурация AgentgatewayBackend для Multiplex MCP
  # Один Backend объединяет все серверы через несколько targets
  backend:
    name: mcp
    namespace: agentgateway-system
  # Конфигурация HTTPRoute для маршрутизации к MCP
  # Один HTTPRoute для всех серверов, все доступны через /mcp
  route:
    name: mcp
    namespace: agentgateway-system
    gateway:
      name: agentgateway-proxy
      namespace: agentgateway-system
