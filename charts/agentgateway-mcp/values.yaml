# Default values for agentgateway-mcp
# Этот файл используется как базовый values.yaml для Helm чарта
# Для переопределений используйте values-dev.yaml или values-prod.yaml

# Конфигурация для MCP серверов (Dynamic MCP)
# Dynamic MCP использует label selector для автоматического обнаружения серверов
# Каждый сервер имеет свой отдельный target в Backend
# Важно: поддерживается только streamable-http транспорт (SSE не поддерживается)
# Документация: https://agentgateway.dev/docs/kubernetes/latest/mcp/dynamic-mcp/
mcp:
  enabled: true
  # Список MCP серверов для развертывания
  # Каждый сервер создает свой Backend и HTTPRoute с уникальным путем
  servers:
    - name: ia-mcp-1
      namespace: agentgateway-system
      image: ia-mcp:latest
      imagePullPolicy: Always
      port: 8000
      replicas: 1
      # Конфигурация Backend для этого сервера
      backend:
        name: ia-mcp-1
        namespace: agentgateway-system
      # Конфигурация HTTPRoute для этого сервера
      route:
        enabled: true
        name: ia-mcp-1
        namespace: agentgateway-system
        # Путь для доступа к этому MCP серверу
        path: /mcp/ia-mcp-1
        gateway:
          name: agentgateway-proxy
          namespace: agentgateway-system
      # Путь MCP endpoint на самом сервере (опционально, по умолчанию /mcp для streamable-http)
      # mcpPath: /mcp
      env:
        - name: MCP_HOST
          value: "0.0.0.0"
        # streamable-http обязателен для Dynamic MCP
        - name: MCP_TRANSPORT
          value: "streamable-http"
        - name: COLUMNS
          value: "200"
    - name: ia-mcp-2
      namespace: agentgateway-system
      image: ia-mcp:latest
      imagePullPolicy: Always
      port: 8000
      replicas: 1
      backend:
        name: ia-mcp-2
        namespace: agentgateway-system
      route:
        enabled: true
        name: ia-mcp-2
        namespace: agentgateway-system
        path: /mcp/ia-mcp-2
        gateway:
          name: agentgateway-proxy
          namespace: agentgateway-system
      env:
        - name: MCP_HOST
          value: "0.0.0.0"
        - name: MCP_TRANSPORT
          value: "streamable-http"
        - name: COLUMNS
          value: "200"
    - name: ia-mcp-3
      namespace: agentgateway-system
      image: ia-mcp:latest
      imagePullPolicy: Always
      port: 8000
      replicas: 1
      backend:
        name: ia-mcp-3
        namespace: agentgateway-system
      route:
        enabled: true
        name: ia-mcp-3
        namespace: agentgateway-system
        path: /mcp/ia-mcp-3
        gateway:
          name: agentgateway-proxy
          namespace: agentgateway-system
      env:
        - name: MCP_HOST
          value: "0.0.0.0"
        - name: MCP_TRANSPORT
          value: "streamable-http"
        - name: COLUMNS
          value: "200"
